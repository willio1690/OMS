<!--
  Copyright © ShopeX （http://www.shopex.cn）. All rights reserved.
  See LICENSE file for license details.
-->

<form id="brandForm" action="index.php?app=brush&ctl=admin_condition&act=save" method="post">
    <input type="hidden" name="farm_id" value="<{$shop_row.farm_id}>">

    <div class="tableform">
        <div class="division">
            <div style="color:red">
                注：1.正常出售的商品货号建议与其他规则条件一起使用，避免系统误判将正常订单判为特殊订单
                2.淘宝旗标只限淘宝平台使用
            </div>
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <th><{t}>规则名称：<{/t}></th>
                    <td colspan="3">
                        <{input type="text" name="farm_name" style="width:240px" value=$shop_row.farm_name}>
                    </td>
                </tr>
                <tr><th><{t}>商城名称：<{/t}></th><td>
                <div class="row">
                    <div class="row-line role-list" style="padding:0 0 0 10px;">
                <{foreach from=$shop_list item=item name=foo}>
                <div class="span-3" style="width:120px">
                    <label>
                        <input type="checkbox"  name="shop_id[]" value="<{$item.shop_id}>" <{if is_array($shop_row.arrShopId) && in_array($item.shop_id, $shop_row.arrShopId)}>checked="checked"<{/if}>/>
                        <{$item.name}>
                    </label>
                </div>
                <{/foreach}>
                </div>
                </div></td>
                </tr>
                <tr>
                    <th><{t}>会员帐号：<{/t}></th>
                    <td colspan="3"><{input type="textarea" name="user_name" style="width:240px"
                        value=$shop_row.user_name}><{t}>（多个用户用英文逗号分割）<{/t}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>收货人手机：<{/t}></th>
                    <td colspan="3"><{input type="textarea" name="ship_mobile" style="width:240px"
                        value=$shop_row.ship_mobile}><{t}>（多个用户用英文逗号分割）<{/t}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>销售物料编码：<{/t}></th>
                    <td colspan="3">
                        <input type="radio" name="product_bn_match" value="0"
                            <{if $shop_row.product_bn_match == 0 }>
                                checked="checked"
                            <{/if}>
                            /> 全部匹配&nbsp;&nbsp;
                        <input type="radio" name="product_bn_match" value="1"
                            <{if $shop_row.product_bn_match == 1 }>
                            checked="checked"
                            <{/if}>
                            /> 部分匹配&nbsp;&nbsp;
                        <br/><{input type="textarea" name="product_bn" style="width:240px"
                        value=$shop_row.product_bn}><{t}>（多个商品货号用英文逗号分割）<{/t}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>订单总额：<{/t}></th>
                    <td colspan="3"><select name="condition">
                        <option value="" >--请选择--</option>
                        <option value="gt" <{if $shop_row.condition eq 'gt'}>selected<{/if}>>大于</option>
                        <option value="lt" <{if $shop_row.condition eq 'lt'}>selected<{/if}>>小于</option>
                        <option value="eq" <{if $shop_row.condition eq 'eq'}>selected<{/if}>>等于</option>
                    </select>&nbsp;<{input type="unsigned" name="money" value=$shop_row.money}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>客户备注：<{/t}></th>
                    <td colspan="3">
                        <{input type="textarea" name="custom_mark" style="width:240px" value=$shop_row.custom_mark}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>商家备注：<{/t}></th>
                    <td colspan="3">
                        <{input type="textarea" name="mark_text" style="width:240px" value=$shop_row.mark_text}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>淘宝旗标：<{/t}></th>
                    <td colspan="3">
                        <{foreach from=$arrMarkType item=item key=key}>
                        <label>
                            <input type='radio' name='mark_type' value='<{$key}>' <{if $shop_row.mark_type==$key}>checked="checked"<{/if}> ><img src='<{$item}>' width='20'height='20'>
                        </label>
                        <{/foreach}>
                        <label>
                            <input type='radio' name='mark_type' value='' <{if $shop_row.mark_type==''}>checked="checked"<{/if}> >不设旗标
                        </label>
                    </td>
                </tr>
                <tr>
                    <th><{t}>详细地址：<{/t}></th>
                    <td colspan="3">
                        <{input type="textarea" name="ship_addr" style="width:240px" value=$shop_row.ship_addr}>
                    </td>
                </tr>
                <tr>
                    <th><{t}>状态：<{/t}></th>
                    <td colspan="3">
                        <input type="radio" name="status" value="1" checked <{if $shop_row.status eq '1'}>checked='checked' <{/if}>/>开启 &nbsp;
                        <input type="radio" value="0" name="status" <{if $shop_row.status eq '0'}> checked='checked' <{/if}>/>关闭
                    </td>
                </tr>
            </table>
        </div>
        <div class="table-action">
            <{button type="submit" id="btn-brand" label="保存"}>
        </div>
    </div>
</form>
<script>

    $('brandForm').store('target', {
        onRequest: function () {
            $('btn-brand').set('disabled', 'true');
        },
        onComplete: function (jsontext) {
            var json = Json.evaluate(jsontext);
            if (typeof(json.error) != 'undefined') {
                $('btn-brand').set('disabled', '');
            } else {
                $('btn-brand').set('disabled', 'true');
                if (opener && opener.finderGroup && opener.finderGroup['<{$env.get.finder_id}>']) {
                    opener.finderGroup['<{$env.get.finder_id}>'].refresh.delay(400, opener.finderGroup['<{$env.get.finder_id}>']);
                    window.close();
                }
            }
        }
    });

    <{if $env.get._finder_name}>
        $('brandForm').store('target', {
            update: 'messagebox'
        });
    <{/if}>
</script>
