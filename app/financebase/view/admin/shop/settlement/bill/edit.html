<!--
  Copyright © ShopeX （http://www.shopex.cn）. All rights reserved.
  See LICENSE file for license details.
-->

<form method="POST" action="index.php?app=financebase&ctl=admin_shop_settlement_bill&act=save" id="bill-edit-form">
<input type="hidden" name="id" value="<{$bill.id}>">
<div class="tableform">
	<div class="division">
		<table width="100%" cellpadding="0" cellspacing="0">
			<tbody>
				<tr>
					<th>收支分类：</th>
					<td>
						<{input type="object" object="bill_category_rules@financebase" key="bill_category" breakpoint=100 value=$bill.bill_category name="bill_category"}>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
<div class="table-action">
    <{button type="submit" label="确定"  class="btn-primary" }> &nbsp; &nbsp;
    <{button label="关闭" class="btn-secondary" isCloseDialogBtn="true"}>
</div>
</form>
<script type="text/javascript">
$('bill-edit-form').store('target',{
    onRequest:function(){
       $E('#bill-edit-form .btn-primary').set('disabled', 'true');
       
    },
    onComplete:function(jsontext){
    	// console.log(jsontext);
       var json = Json.evaluate(jsontext);
       if (typeof(json.error) != 'undefined'){
           $E('#bill-edit-form .btn-primary').set('disabled', '');
       }else{
           $E('#bill-edit-form .btn-primary').set('disabled', 'true');

           $('bill-edit-form').getParent('.dialog').retrieve('instance').close();

           finderGroup['<{$env.get.finder_id}>'].refresh.delay(400,finderGroup['<{$env.get.finder_id}>']);
       }
    }
});
</script>